# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool:
  vmImage: ubuntu-20.04

steps:
- script: ./getSource
  displayName: 'Download pristine MySQL 5.7.x sources'

- script: | 
    apt update && apt upgrade && apt install -y devscripts \
    bison chrpath cmake debhelper dh-apparmor libaio-dev libedit-dev libevent-dev \
    liblz4-dev libncurses5-dev libnuma-dev libssl-dev libwrap0-dev po-debconf \
    zlib1g-dev dh-systemd && \
    cd upstream.src && debuild -b -uc -us
  displayName: 'Install build tools, deps, and try binary build'
