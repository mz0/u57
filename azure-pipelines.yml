# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool:
  vmImage: ubuntu-20.04

steps:
- script: | 
    sudo apt update && sudo apt upgrade && sudo apt install -y devscripts \
    bison chrpath cmake debhelper dh-apparmor libaio-dev libedit-dev libevent-dev \
    liblz4-dev libncurses5-dev libnuma-dev libssl-dev libwrap0-dev po-debconf \
    zlib1g-dev dh-systemd pkg-config psmisc
  displayName: 'Install build tools and deps'

- script: ./getSource
  displayName: 'Download pristine MySQL 5.7.x sources'

- script: cd upstream.src && debuild -uc -us -b
  displayName: 'Build  binary packages (but do not sign)'
